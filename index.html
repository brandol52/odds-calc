<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Odds Calc</title>

  <style>
    :root{--bg:#0c111b;--fg:#edf2f7;--muted:#9aa4b2;--card:#0f172a;--border:#1f2537;--accent:#22c55e}
    *{box-sizing:border-box}
    body{
      margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:var(--bg);color:var(--fg);
      min-height:100vh;display:flex;flex-direction:column;
      padding-top:calc(env(safe-area-inset-top) + 12px);
      padding-bottom:env(safe-area-inset-bottom);
      padding-left:env(safe-area-inset-left);padding-right:env(safe-area-inset-right);
    }
    .wrap{max-width:560px;width:100%;margin:0 auto;padding:16px;flex:1;display:flex;flex-direction:column}
    h1{font-size:18px;margin:10px 0 12px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:12px}
    .inputs-line{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:8px}
    label{display:block;font-size:.85rem;color:var(--muted);margin-bottom:6px}
    .odds-line{display:grid;grid-template-columns:56px 1fr;gap:8px}
    .btn{padding:12px;border-radius:12px;border:1px solid var(--border);background:#0d1930;color:var(--fg);font-size:1.05rem;cursor:pointer}
    .btn:active{transform:translateY(1px)}
    .btn-clear{width:100%;margin:10px 0;padding:14px;font-size:1rem;background:#1a2238}
    input[type="text"]{
      width:100%;padding:12px 14px;border-radius:12px;background:#0a1020;color:var(--fg);
      border:1px solid var(--border);outline:none;font-size:1.05rem
    }
    input:focus{border-color:#2dd4bf;box-shadow:0 0 0 .12rem rgba(45,212,191,.16)}
    input.invalid{border-color:#f87171 !important;box-shadow:0 0 0 .12rem rgba(248,113,113,.25)}
    .error{color:#f87171;font-size:.85rem;margin-top:4px;display:none}
    .stake{margin-top:10px;background:#0a1020;border:1px solid var(--border);border-radius:12px;padding:16px;text-align:center}
    .stake small{display:block;color:var(--muted);font-size:.85rem;margin-bottom:6px}
    .stake .val{font-weight:900;letter-spacing:.2px;font-size:2rem;color:var(--accent)}
    .stake .be-label{margin-top:10px;font-size:.85rem;color:var(--muted);text-align:left}
    .stake .be{font-size:.95rem;font-weight:600;color:var(--fg);text-align:left}
    .foot{color:var(--muted);font-size:.78rem;text-align:center;margin:14px 0 8px}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>American Odds — App Mode</h1>

    <div class="card">
      <div class="inputs-line">
        <div>
          <label for="odds">American Odds</label>
          <div class="odds-line">
            <button type="button" class="btn" id="toggleBtn">−</button>
            <input id="odds" type="text" inputmode="numeric" placeholder="-110 or +145">
          </div>
          <div class="error" id="oddsError">Odds must be ≤ -100 or ≥ +100</div>
        </div>
        <div>
          <label for="win">Amount to Win</label>
          <input id="win" type="text" inputmode="numeric" placeholder="$25.00">
        </div>
      </div>

      <button type="button" class="btn btn-clear" id="clearBtn">Clear</button>

      <div class="stake">
        <small>Required Amount to Bet</small>
        <div class="val" id="stake">$0.00</div>
        <div class="be-label">Implied Win Rate</div>
        <div class="be" id="breakeven">—</div>
      </div>
    </div>

    <div class="foot">
      © Bryan Randol<br>
      <small id="version">Build v08-18-2025-13</small>
    </div>
  </div>

  <script>
    const VERSION="v08-18-2025-13";document.getElementById("version").textContent="Build "+VERSION;
    const $=id=>document.getElementById(id);
    const money=v=>(isFinite(v)?(Math.round(v*100)/100).toLocaleString(undefined,{style:'currency',currency:'USD'}):"$0.00");

    function parseOdds(r){if(!r)return null;r=String(r).trim();if(/^[+-]?\d+$/.test(r))return parseFloat(r);const c=r.replace(/[^\d\-+]/g,"");if(c===""||c==="+"||c==="-")return null;return parseFloat(c);}
    function validOdds(n){return(n<=-100||n>=100);}
    function formatOddsField(o){const e=$("odds");if(o==null||!isFinite(o))return;const a=Math.abs(Math.trunc(o));e.value=(o>0? "+"+a:"-"+a);}
    function getWinCents(){const e=$("win");return e?.dataset.cents?parseInt(e.dataset.cents,10):0;}
    function setWinCents(c){const e=$("win");if(!e)return;c=Math.max(0,isFinite(c)?Math.trunc(c):0);e.dataset.cents=String(c);e.value=(c/100).toLocaleString(undefined,{style:"currency",currency:"USD"});}
    function handleWinInput(e){const d=(e.target.value.match(/\d/g)||[]).join("");const c=d===""?0:parseInt(d,10);setWinCents(c);calculate();}
    function handleWinKeyDown(e){const a=["Backspace","Delete","ArrowLeft","ArrowRight","Tab","Home","End"];if(a.includes(e.key))return;if(/^\d$/.test(e.key))return;e.preventDefault();}
    function pasteDigitsOnly(e){e.preventDefault();const t=(e.clipboardData||window.clipboardData||{getData:()=>""}).getData("text");const d=(t.match(/\d/g)||[]).join("");const c=d===""?getWinCents():parseInt(d,10);setWinCents(c);calculate();}
    function calcStake(o,w){if(o==null||!isFinite(o)||!isFinite(w)||o===0)return NaN;return o>0?(w*100/o):(w*Math.abs(o)/100);}
    function impliedProb(o){if(o==null||!isFinite(o)||!validOdds(o))return null;if(o>0)return 100/(o+100);return Math.abs(o)/(Math.abs(o)+100);}
    function updateToggleLabel(o){const b=$("toggleBtn");const m=(o!=null&&isFinite(o)&&o>0);b.textContent=m?"−":"+";}
    function calculate(){
      const oe=$("odds"),ee=$("oddsError"),se=$("stake"),be=$("breakeven");
      const o=parseOdds(oe?.value||"");const w=getWinCents()/100;
      if(o==null||!isFinite(o)||!validOdds(o)){
        if(se)se.textContent="$0.00";if(ee)ee.style.display="block";if(be)be.textContent="—";if(oe)oe.classList.add("invalid");
      }else{
        const s=calcStake(o,w);if(se)se.textContent=money(s);if(ee)ee.style.display="none";if(oe)oe.classList.remove("invalid");formatOddsField(o);
        const p=impliedProb(o);if(be&&p!=null){be.textContent=(p*100).toFixed(2)+"%";}
      }
      updateToggleLabel(o);
    }
    function bind(){
      const oe=$("odds"),we=$("win"),b=$("toggleBtn"),cb=$("clearBtn");
      if(!oe||!we||!b||!cb)return false;
      b.addEventListener("click",()=>{let n=parseOdds(oe.value);n=(n==null||!isFinite(n))?-110:(n*-1);oe.value=String(n);calculate();});
      oe.addEventListener("input",calculate);oe.addEventListener("blur",()=>{const n=parseOdds(oe.value);if(n!=null&&isFinite(n)&&validOdds(n))formatOddsField(n);});
      we.addEventListener("input",handleWinInput);we.addEventListener("keydown",handleWinKeyDown);we.addEventListener("paste",pasteDigitsOnly);
      cb.addEventListener("click",()=>{oe.value="";we.value="";we.dataset.cents="0";$("stake").textContent="$0.00";$("oddsError").style.display="none";$("breakeven").textContent="—";oe.classList.remove("invalid");});
      return true;
    }
    function init(){if(!bind()){setTimeout(init,50);return;}$("odds").value="-110";setWinCents(2500);calculate();}
    if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",init);}else{init();}
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Odds Calc — Stake Chart (Syrax)</title>
  <meta name="theme-color" content="#5A1414">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icons/favicon.ico">
  <style>
    :root{--bg:#0c111b;--fg:#edf2f7;--muted:#9aa4b2;--card:#0f172a;--border:#1f2537}
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    .wrap{max-width:560px;margin:0 auto;padding:12px;display:grid;row-gap:10px}
    h1{margin:6px 0 2px;font-size:18px}
    .muted{color:var(--muted)} .small{font-size:12px}

    .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:14px;display:flex;flex-direction:column;gap:10px}
    label{display:block;margin-bottom:6px;color:var(--muted);font-size:13px}
    .field{position:relative}
    input[type=text]{width:100%;background:#0b1324;border:1px solid var(--border);border-radius:10px;color:var(--fg);
      padding:10px 12px;font-size:16px;outline:none;-webkit-appearance:none}
    input[type=text]:focus{border-color:#334155;box-shadow:0 0 0 2px #33415555}

    /* Chart */
    .chartCard{gap:8px}
    .chartHeader{display:flex;justify-content:space-between;font-size:12px;color:var(--muted)}
    .grid{
      column-count:4;
      column-gap:6px;
    }
    /* tighter on very small screens */
    @media (max-width:390px){ .grid{ column-count:4; } }
    @media (max-width:360px){ .grid{ column-count:5; } } /* add a column if super narrow to keep height down */

    .cell{
      break-inside:avoid; /* keep boxes intact across columns */
      display:flex;justify-content:space-between;align-items:center;
      padding:6px 8px;margin:0 0 6px 0;border:1px solid var(--border);border-radius:8px;
      background:#0c1428;font-variant-numeric:tabular-nums;font-size:11px;line-height:1.1;
    }
    .odds{opacity:.85}
    .amt{font-weight:600}
    footer{font-size:12px;color:var(--muted);text-align:center;padding:4px 0 10px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Stake Chart</h1>
      <div class="muted small">Enter desired win → see stake for –500…–105 (×5)</div>
    </header>

    <section class="card">
      <label for="win">Desired Win ($)</label>
      <div class="field">
        <input id="win" type="text" inputmode="numeric" placeholder="$0.00" autocomplete="off" autocorrect="off" spellcheck="false">
      </div>
    </section>

    <section class="card chartCard">
      <div class="chartHeader">
        <div>American Odds</div>
        <div>Stake Required</div>
      </div>
      <div id="grid" class="grid" aria-live="polite"></div>
    </section>

    <footer>
      Built by <strong>Bryan Randol</strong> • Build-Syrax
    </footer>
  </div>

<script>
const USD = new Intl.NumberFormat('en-US',{style:'currency',currency:'USD',minimumFractionDigits:2,maximumFractionDigits:2});
const fmtUSD = n => USD.format(n);
const readMoney = el => {
  const digits=(el.value.match(/\d+/g)||[]).join("");
  return digits===""?0:parseInt(digits,10)/100;
};
function maskMoney(el){
  const digits=(el.value.match(/\d+/g)||[]).join("");
  const cents=digits===""?0:parseInt(digits,10);
  el.value=USD.format((isNaN(cents)?0:cents)/100);
}
function stakeForNegOdds(absNegOdds, win){
  // For negative American odds (-X), stake = win * X / 100
  return (win * absNegOdds) / 100;
}
function renderGrid(winAmt){
  const grid=document.getElementById('grid');
  grid.innerHTML="";
  // –500 to –105 inclusive, step +5 (less negative)
  for(let o= -500; o<= -105; o+=5){
    const stake = stakeForNegOdds(Math.abs(o), winAmt);
    const div=document.createElement('div');
    div.className='cell';
    const odds=document.createElement('div');
    odds.className='odds';
    odds.textContent = String(o);
    const amt=document.createElement('div');
    amt.className='amt';
    amt.textContent = fmtUSD(stake);
    div.appendChild(odds);
    div.appendChild(amt);
    grid.appendChild(div);
  }
}

function init(){
  const winEl=document.getElementById('win');
  // Initialize
  winEl.value="$0.00";
  renderGrid(0);

  winEl.addEventListener('input', ()=>{
    maskMoney(winEl);
    const w=readMoney(winEl);
    renderGrid(w);
  });

  // PWA SW (no-op if missing)
  if('serviceWorker' in navigator){
    navigator.serviceWorker.register('service-worker.js').catch(()=>{});
  }
}
if(document.readyState==="loading") document.addEventListener("DOMContentLoaded", init); else init();
</script>
</body>
</html>
